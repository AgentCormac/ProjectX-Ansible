---
- name: Build Jenkins
  hosts: all
  vars:
    jenkins_hostname: 192.168.100.102
    jenkins_home: /vagrant/jenkins
    jenkins_plugins: [Cobertura, GitHub, Violations]
    jenkins_plugins_state: present
  roles:
    - role: geerlingguy.java
      when: "ansible_os_family == 'RedHat'"
      java_packages:
        - java-1.8.0-openjdk    
    - role: geerlingguy.jenkins
      become: true
  tasks:
    - name: Add epel repository
      yum_repository:
      description: EPEL YUM repo
      baseurl: https://download.fedoraproject.org/pub/epel/7/x86_64/
      state: present
      - name: install basic packages
      yum: pkg={{item}} state=latest update_cache=yes
      with_items:
        - vim
        - git
        - python
        - python-nose
        - python-coverage
    - name: install the latest version of pylint
      yum:
        name: pylint
        state: latest
        enablerepo: epel
        disable_gpg_check: true
    - name: install the latest version of python-mock
      yum:
        name: python-mock
        state: latest
        enablerepo: epel
        disable_gpg_check: true
